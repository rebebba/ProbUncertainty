install.packages(
"datapasta",
repos = c(mm = "https://milesmcbain.r-universe.dev", getOption("repos")))
install.packages(
"datapasta",
repos = c(mm = "https://milesmcbain.r-universe.dev", getOption("repos")))
install.packages(
"ggplot", dependencies = TRUE)
install.packages(
"ggplot2", dependencies = TRUE)
# load required packages
devtools::install(pkg = "../../GitHub/GLMuncertainty/")
setwd("~/1 University of St Andrews/ContingencyTables_Chi2")
# load required packages
devtools::install(pkg = "../../GitHub/GLMuncertainty/")
library("GLMuncertainty")
# load data
data("startrek")
?startrek
table(startrek)
# since we are only interested in the survival of characters who wear red Starfleet uniforms
# verses those that do not, we will merge characters who wear blue and gold uniforms
startrek$uniform <- ifelse(startrek$uniform == "red", 1, 0)
startrek$status <- ifelse(startrek$status == "dead", 1, 0)
#### chi square test ----
chisq.test(startrek$uniform, startrek$status, correct = FALSE)
#### linear regression ----
lm_redshirt <- lm(status ~ uniform, data = startrek)
summary(lm_redshirt)
# extract the estimated difference in probabilities, standard error, p value
summary(lm_redshirt)$coefficients[2, 1]
summary(lm_redshirt)$coefficients[2, 2]
summary(lm_redshirt)$coefficients[2, 4]
#### logistic glm ----
glm_redshirt <- glm(status ~ uniform, data = startrek, family = "binomial")
summary(glm_redshirt)
# extract the estimated difference in probabilities (logit scale), standard error
summary(glm_redshirt)$coefficients[2, 1]
summary(glm_redshirt)$coefficients[2, 2]
# null model for p-value based on LRT
glm_0 <- glm(status ~ 1, data = startrek, family = "binomial")
# extract p value
as.numeric(1 - pchisq(2 * (logLik(glm_redshirt) - logLik(glm_0)), 1))
# translate from the logit / log-odds scale to the probability (data) scale
# and calculate difference in probabilities
glm.prob.diff(glm_redshirt)
More specifically,
glm.se.data(glm_redshirt)
profCI(x = startrek$uniform, y = startrek$status)
scoreCI(x = startrek$uniform, y = startrek$status)
?glm.se.data
glm.se.data(lm_redshirt)
?profCI
setwd("~/GitHub/GLMuncertainty")
devtools::check()
devtools::document()
